<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multiple Choice</title>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
    <link
      rel="stylesheet"
      href="http://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/static/styles.css" />
    <script>
      function save_answer(answer) {
        $.ajax({
          url: "/save_answer",
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify(answer),
          success: function (response) {
            console.log("Results saved successfully");

            if ("{{quiz.next}}" === "end") {
              window.location.href = "/quiz/results/1";
            } else {
              window.location.href = "/quiz/{{quiz.next}}";
            }
          },
          error: function () {
            console.log("Error saving results");
          },
        });
      }

      $(document).ready(function () {
        var correctSVG =
          '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="green" style="float:right; margin-top: 2px;" viewBox="0 0 24 24"><path d="M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"/></svg>';
        var wrongSVG =
          '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(182, 24, 24)" style="float:right; margin-top: 2px;" viewBox="0 0 24 24"><path d="M23 20.168l-8.185-8.187 8.185-8.174-2.832-2.807-8.182 8.179-8.176-8.179-2.81 2.81 8.186 8.196-8.186 8.184 2.81 2.81 8.203-8.192 8.18 8.192z"/></svg>';

        $("#submit").click(function () {
          let userAnswer = $('input[name="option"]:checked').val();
          let correctAnswer = "{{ quiz.answer }}";

          $("#quiz-choices").hide();
          $("#quiz-choices-disabled").show();

          $("#submit").hide();
          $("#next").show();

          // Iterate over the disabled list to apply styles
          $("#quiz-choices-disabled label").each(function () {
            let choiceText = $(this).text().trim();

            if (choiceText === correctAnswer) {
              $(this).addClass("correct-answer");
              $(this).append(correctSVG);
            }
            if (choiceText === userAnswer && userAnswer !== correctAnswer) {
              $(this).addClass("incorrect-answer");
              $(this).append(wrongSVG);
            }
          });
        });

        $("#next").click(function () {
          let userAnswer = $('input[name="option"]:checked').val();
          save_answer(userAnswer);
        });
        
      });
    </script>
  </head>

  <body>
    {% include 'navbar.html' %}
    <div class="m-4 container text-center">
      <h1>{{ quiz.question }}</h1>

      <div class="row">
        <div class="col"></div>
        <div class="col">
          {% if quiz.image %}
          <img src="{{ quiz.image }}" class="img-fluid quiz-image" />
          {% endif %}

          <ul class="quiz-list" id="quiz-choices">
            {% for choice in quiz.choices %}
            <li>
              <input
                class="answer"
                type="radio"
                name="option"
                id="{{ choice }}"
                value="{{ choice }}"
              />
              <label class="border p-3" for="{{ choice }}">{{ choice }}</label>
            </li>
            {% endfor %}
          </ul>

          <ul class="quiz-list" id="quiz-choices-disabled">
            {% for choice in quiz.choices %}
            <li>
              <label class="border p-3" for="{{ choice }}">{{ choice }}</label>
            </li>
            {% endfor %}
          </ul>

          <div class="row mt-4">
            <div class="col">
              <button id="submit" class="custombutton greenbutton">
                Submit
              </button>
              <button id="next" class="custombutton bluebutton">Next</button>
            </div>
          </div>
        </div>
        <div class="col"></div>
      </div>

      <!-- 
        <div class="text-center">
            {% if quiz.image %}
            <img src="{{ quiz.image }}" style="height: 300px;">
            {% endif %}
        </div>

        <ul class="quiz-list">
            {% for choice in quiz.choices %}
            <li>
                <input class="answer" type="radio" name="option" id="{{ choice }}" value="{{ choice }}">
                <label class="border p-3" for="{{ choice }}">{{ choice }}</label>
            </li>
            {% endfor %}
        </ul>


    </div>

</body>

</html>

d-flex flex-column align-items-center -->

      <!-- 
        <div class="row">
            <form class="col">
                <ul class="quiz-list">
                    {% for choice in quiz.choices %}
                    <li>
                        <input class="answer" type="radio" name="option" id="{{ choice }}" value="{{ choice }}">
                        <label class="border p-3" for="{{ choice }}">{{ choice }}</label>
                    </li>
                    {% endfor %}
                </ul>
            </form>


            <div class="col">
                {% if quiz.image %}
                <img src="{{ quiz.image }}" class="img-fluid">
                {% endif %}
            </div>

        </div> -->
    </div>
  </body>
</html>
